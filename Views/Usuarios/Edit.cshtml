@model Caribbean2.Models.Usuarios

@{
    ViewData["Title"] = "Edit";
}

@{
    ViewData["Title"] = "Logeados";
    @* Layout = null; *@
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sidebar</title>
    @* <link rel="stylesheet" href="~/css/sideBar.css">
    <link rel="stylesheet" href="~/css/roles.css">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/menuCentral.css">
    <link rel="stylesheet" href="~/css/logeados.css">
     <link rel="stylesheet" href="~/css/login.css"> 
    <link rel="stylesheet" href="~/css/logeados.css">
    <link rel="stylesheet" href="~/css/form.css">
    <link rel="stylesheet" href="~/css/Usuarios.css"> *@

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600&family=Nunito:wght@600;700;800&display=swap"
          rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">


    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

    @* <div class="menu">
        <ion-icon name="menu-outline"></ion-icon>
        <ion-icon name="close-outline"></ion-icon>
    </div>

    <div class="barra-lateral">
        <div>
            <div class="nombre-pagina">
                <ion-icon id="cloud" name="cloud-outline"></ion-icon>
                <span>CaribeanBliss</span>
            </div>
        </div>

        <nav class="navegacion">
            <ul>
                <li>
                    <a id="home" asp-controller="Caribbean" asp-action="Index">
                        <ion-icon name="home-outline"></ion-icon>
                        <span>Home</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Caribbean" asp-action="Dashboard">
                        <ion-icon name="stats-chart-outline"></ion-icon>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Caribbean" asp-action="logeados">
                        <ion-icon name="people-outline"></ion-icon>
                        <span>Usuarios</span>
                    </a>
                </li>
                <li>
                    <div class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                            <ion-icon name="bed-outline"></ion-icon>
                            <span>Alojamiento</span>
                        </a>
                        <div class="dropdown-menu m-0">
                            <a class="dropdown-item" asp-controller="Caribbean" asp-action="Huespedes">Huespedes</a>
                            <a class="dropdown-item" asp-controller="Caribbean" asp-action="Reservas">Reservas</a>
                            <a class="dropdown-item" asp-controller="Caribbean" asp-action="Habitaciones">Habitaciones</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a asp-controller="Caribbean" asp-action="Servicios">
                        <ion-icon name="briefcase-outline"></ion-icon>
                        <span>Servicios</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Caribbean" asp-action="Roles">
                        <ion-icon name="key-outline"></ion-icon>
                        <span>Roles</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Caribbean" asp-action="Contacto">
                        <ion-icon name="call-outline"></ion-icon>
                        <span>Contacto</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="caribean_logo">
            <img src="~/img/caribeanbliss_logo.png" alt="Home" srcset="">
        </div>

        <div>
            <div class="linea"></div>

            <div class="modo-oscuro">
                <div class="info">
                    <ion-icon name="moon-outline"></ion-icon>
                    <span>Modo Dark</span>
                </div>
                <div class="switch">
                    <div class="base">
                        <div class="circulo">
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div> *@


    <main>
        <header class="container-fluid bg-dark px-5 mb-2">
            <div class="container-fluid bg-dark px-5 d-lg-block d justify-content-around mb-2">
                @* <div class="row gx-0 p-2 align-items-center">
                    <div class="btn-group-container d-flex justify-content-end">
                        <a href="" class="btn-modern d-flex d-lg-none" data-bs-toggle="tooltip"
                           data-bs-placement="bottom" title="Registrarse">
                            <i class="fas fa-user-plus"></i>
                        </a>
                        <a href="" class="btn-modern me-2 d-none d-lg-inline-flex">
                            <i class="fas fa-sign-in-alt"></i> Cerrar sesión
                        </a>
                    </div>
                </div> *@
            </div>
        </header>
        <!-- SECCION MODIFICABLE -->
        <header>
            <div class="edit-user-container">
                <h1 class="edit-user-title">Editar Usuario</h1>
                <form asp-action="Edit" class="edit-form">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <input type="hidden" asp-for="UsuarioID" />
    
    <div class="form-group">
        <label asp-for="NombresApellidos" class="control-label">Nombre Usuario</label>
        <input asp-for="NombresApellidos" class="form-control" 
               pattern="^[a-zA-Z0-9]{6,30}$"
               title="El nombre debe ser alfanumérico y tener entre 6 y 30 caracteres"
               required />
        <span asp-validation-for="NombresApellidos" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="TipoIdentificacion" class="control-label">Tipo Identificación</label>
        <select asp-for="TipoIdentificacion" class="form-control" required>
            <option value="">Seleccione...</option>
            <option value="CC">CC</option>
            <option value="TI">TI</option>
            <option value="CE">CE</option>
            <option value="PAS">PAS</option>
            <option value="NIT">NIT</option>
        </select>
        <span asp-validation-for="TipoIdentificacion" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Identificacion" class="control-label"></label>
        <input asp-for="Identificacion" class="form-control"
               pattern="^[0-9]{6,15}$"
               title="El número de identificación debe ser numérico entre 6 y 15 dígitos"
               required />
        <span asp-validation-for="Identificacion" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Telefono" class="control-label"></label>
        <input asp-for="Telefono" class="form-control"
               pattern="^\d{10}$"
               title="El número de teléfono debe contener exactamente 10 dígitos"
               required />
        <span asp-validation-for="Telefono" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Correo" class="control-label"></label>
        <input asp-for="Correo" class="form-control"
               pattern="^[a-zA-Z0-9]{5,}[a-zA-Z0-9.-]+\.com$"
               title="El correo debe ser válido, tener al menos 5 caracteres antes del  y terminar en .com"
               required />
        <span asp-validation-for="Correo" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="FechaRegistro" class="control-label"></label>
        <input asp-for="FechaRegistro" class="form-control" readonly />
        <span asp-validation-for="FechaRegistro" class="text-danger"></span>
    </div>

    <div class="form-group">
    <label asp-for="Estado" class="control-label">Estado</label>
    <div class="toggle-container">
        <div class="form-check form-switch">
            <input class="form-check-input" asp-for="Estado" type="checkbox" role="switch" id="estadoSwitch">
            <label class="form-check-label" for="estadoSwitch">
                <span id="estadoLabel">@(Model.Estado ? "Activo" : "Inactivo")</span>
            </label>
        </div>
    </div>
</div>
<div class="form-group">
    <label asp-for="IdRol" class="control-label">Rol</label>
    <select asp-for="IdRol" class="form-control" required>
        <option value="">Seleccione un rol...</option>
        <option value="1">Usuario</option>
        <option value="2">Administrador</option>
        <option value="3">Empleado</option>
        <option value="4">Supervisor</option>
    </select>
    <span asp-validation-for="IdRol" class="text-danger"></span>
</div>

    @* <div class="form-group">
        <label asp-for="IdRol" class="control-label">Rol</label>
        <select asp-for="IdRol" class="form-control" 
                asp-items="@(ViewBag.Roles as SelectList)" required>
            <option value="">Seleccione un rol...</option>
        </select>
        <span asp-validation-for="IdRol" class="text-danger"></span>
    </div> *@

    <div class="form-group d-flex justify-content-between align-items-center">
        <input type="submit" value="Guardar" class="btn btn-primary" />
        <a asp-action="Index" class="back-link">
            <i class="fas fa-arrow-left fa-2x" style="color: #007bff;"></i> 
            <span style="color: #007bff;">Volver A la Lista</span>
        </a>
    </div>
</form>
            </div>
        </header>
<link rel="stylesheet" href="~/css/edit-user.css">
<style>
    .toggle-container {
    margin-top: 8px;
}

.form-switch {
    padding-left: 2.5em;
    position: relative;
}

.form-check-input[type="checkbox"] {
    width: 40px;
    height: 20px;
    cursor: pointer;
}

.form-check-input:checked {
    background-color: #198754;
    border-color: #198754;
}

.form-check-input:not(:checked) {
    background-color: #dc3545;
    border-color: #dc3545;
}

.form-check-label {
    margin-left: 10px;
    user-select: none;
}
.edit-user-container {
    background: #ffffff;
    border-radius: 8px;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
    padding: 2rem;
    margin: 1rem auto;
    width: 95%;
    max-width: 1400px;
}

.edit-form {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
    padding: 1rem;
}

.edit-user-title {
    color: #2c3e50;
    font-size: 1.8rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    text-align: left;
    border-bottom: 2px solid #e9ecef;
    padding-bottom: 0.5rem;
    grid-column: 1 / -1;
}

.form-group {
    display: flex;
    flex-direction: column;
    margin-bottom: 0.8rem;
}

.form-group.form-check {
    flex-direction: row;
    align-items: center;
    gap: 0.5rem;
}

.form-control {
    height: 38px;
    padding: 0.375rem 0.75rem;
}

.form-group.d-flex.justify-content-between {
    grid-column: 1 / -1;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid #e9ecef;
}

.btn-primary {
    min-width: 120px;
    height: 40px;
    background-color: #007bff;
    border-color: #007bff;
    color: white;
}

.btn-primary:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}

.edit-form .control-label {
    margin-bottom: 0.3rem;
    font-size: 0.9rem;
}

/* Responsive adjustments */
@* @media (max-width: 1200px) {
    .edit-form {
        grid-template-columns: repeat(3, 1fr);
    }
}

@media (max-width: 992px) {
    .edit-form {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 576px) {
    .edit-form {
        grid-template-columns: 1fr;
    }
} *@
</style>
     </body>
     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

     <script>
     $(document).ready(function() {
         $("form").on("submit", function(e) {
             e.preventDefault();
             const form = $(this);
             
             // Validar el formulario antes de enviar
             if (!form[0].checkValidity()) {
                 form[0].reportValidity();
                 return;
             }

             Swal.fire({
                 title: '¿Estás seguro?',
                 text: "¿Deseas guardar los cambios realizados?",
                 icon: 'warning',
                 showCancelButton: true,
                 confirmButtonColor: '#3085d6',
                 cancelButtonColor: '#d33',
                 confirmButtonText: 'Sí, guardar cambios',
                 cancelButtonText: 'Cancelar'
             }).then((result) => {
                 if (result.isConfirmed) {
                     $.ajax({
                         url: form.attr('action'),
                         type: 'POST',
                         data: form.serialize(),
                         success: function(response) {
                             if (response.success) {
                                 Swal.fire({
                                     title: '¡Éxito!',
                                     text: response.message,
                                     icon: 'success'
                                 }).then(() => {
                                     window.location.href = '@Url.Action("Index", "Usuarios")';
                                 });
                             } else {
                                 Swal.fire({
                                     title: 'Error',
                                     text: response.message,
                                     icon: 'error'
                                 });
                             }
                         },
                         error: function(xhr) {
                             Swal.fire({
                                 title: 'Error',
                                 text: 'Ocurrió un error al guardar los cambios',
                                 icon: 'error',
                                 confirmButtonText: 'Ok'
                             });
                         }
                     });
                 }
             });
         });
     });
     </script>
  </html>